(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{1373:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}t.default=e}(r(1));var n,a=u(r(9)),o=u(r(25)),i=u(r(1237));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t,r=e.children,u=e.tag,s=void 0===u?"h2":u,l=e.isFlush,d=void 0!==l&&l;return function(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});if(1===i)t.children=a;else if(i>1){for(var s=new Array(i),l=0;l<i;l++)s[l]=arguments[l+3];t.children=s}return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}(o.default,{className:(0,a.default)(i.default.heading,(t={},t[i.default.flush]=d,t)),color:o.default.Colors.WHITE,size:o.default.Sizes.LARGE,tag:s,weight:o.default.Weights.MEDIUM},void 0,r)};s.displayName="PageHeading";var l=s;t.default=l},1374:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}t.default=e}(r(1));var n,a=u(r(9)),o=u(r(25)),i=u(r(1238));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t,r=e.children,u=e.className,s=e.tag,l=void 0===s?"p":s,d=e.isFlush,f=void 0!==d&&d;return function(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});if(1===i)t.children=a;else if(i>1){for(var s=new Array(i),l=0;l<i;l++)s[l]=arguments[l+3];t.children=s}return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}(o.default,{className:(0,a.default)(i.default.subheading,u,(t={},t[i.default.flush]=f,t)),color:o.default.Colors.PRIMARY_300,size:o.default.Sizes.MEDIUM_LARGE,tag:l,weight:o.default.Weights.NORMAL},void 0,r)};s.displayName="PageSubheading";var l=s;t.default=l},1375:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=s(r(1)),a=u(r(9)),o=s(r(177)),i=u(r(1239));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var d=function(e){var t,r;function u(){return e.apply(this,arguments)||this}return r=e,(t=u).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,u.prototype.render=function(){var e=this.props,t=e.className,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["className"]);return n.createElement(o.default,l({},r,{className:(0,a.default)(i.default.formStatusAlert,t)}))},u}(n.Component);t.default=d,d.displayName="FormStatusAlert",d.Types=o.AlertTypes},1458:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=p(r(1)),o=f(r(9)),i=p(r(52)),u=f(r(420)),s=f(r(422)),l=r(21),d=f(r(1270));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function c(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});if(1===i)t.children=a;else if(i>1){for(var s=new Array(i),l=0;l<i;l++)s[l]=arguments[l+3];t.children=s}return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function h(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var v=function(e){function t(t){var r;return(r=e.call(this,t)||this).hasError=function(e){var t=r.props.validator;return null!=t&&!t(e)},r.handleInputBlur=function(e,t){var n=e.currentTarget.value;r.setState({hasError:r.hasError(n)}),r.props.onChange(t,n)},r.handleRemoveClick=function(){var e=r.props,t=e.name;(0,e.onRemove)(t)},r.state={hasError:r.hasError(t.value)},r}return h(t,e),t.prototype.render=function(){var e,t=this.state.hasError,r=this.props,n=r.name,a=r.maxLength,i=r.validator,l=r.value,f=null!=i;return c("div",{className:d.default.inputWrapper},void 0,c(s.default,{className:d.default.input,inputClassName:(0,o.default)((e={},e[d.default.isValid]=f&&l&&!t,e[d.default.hasError]=f&&l&&t,e)),name:n,defaultValue:l,onBlur:this.handleInputBlur,maxLength:a}),c("button",{className:d.default.removeButton,onClick:this.handleRemoveClick,tabIndex:-1,type:"button"},void 0,c(u.default,{className:d.default.removeButtonIcon,name:u.default.Names.CLOSE})))},t}(a.PureComponent);v.displayName="Input";var m=function(e){return{inputs:e.values}},y=function(e){var t=e.split("#")[1];return Number(t)},g=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).state=m(t.props),t.getButtonText=function(){if(t.state.inputs.length>0)return l.Messages.MultiTextInput.ADD_ANOTHER;var e=t.props.type.substr(0,1).toUpperCase()+t.props.type.substr(1);return l.Messages.MultiTextInput.ADD_ONE.format({name:e})},t.handleAddClick=function(){var e=t.props.onChange,r=[].concat(t.state.inputs,[""]);t.setState({inputs:r}),e&&e(r)},t.handleInputChange=function(e,r){var n=t.props.onChange;if(null!=e){var a=[].concat(t.state.inputs);a[y(e)]=r,t.setState({inputs:a}),n&&n(a)}},t.handleInputRemove=function(e){if(!(t.state.inputs.length<=0)){var r=t.props.onChange,n=[].concat(t.state.inputs);n.splice(y(e),1),t.setState({inputs:n}),r&&r(n)}},t.resetInputFields=function(){t.setState(m(t.props))},t}h(t,e);var r=t.prototype;return r.renderAddAction=function(){var e=this.props.maxCount,t=this.state.inputs;return null!=e&&t.length>=e?null:c(i.default,{height:i.ButtonHeight.MEDIUM,onClick:this.handleAddClick},void 0,this.getButtonText())},r.renderInputFields=function(){var e,t=this,r=this.props,n=r.maxCount,a=r.maxLength,i=r.namePrefix,u=r.type,s=r.validator,l=this.state.inputs;if(0===l.length)return null;var f=l.map(function(e,r){return c(v,{type:u,maxLength:a,name:i+"#"+r,value:e,onChange:t.handleInputChange,onRemove:t.handleInputRemove,validator:s},e+"-"+r)});return c("div",{className:(0,o.default)(d.default.inputsWrapper,(e={},e[d.default.inputsWrapperFlush]=null!=n&&l.length>=n,e))},void 0,f)},r.render=function(){return c("div",{},void 0,this.renderInputFields(),this.renderAddAction())},t}(a.PureComponent);g.displayName="TextboxInputRepeater",g.defaultProps={values:[]};var S=g;t.default=S},2208:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=O(r(1)),o=E(r(15)),i=O(r(129)),u=O(r(2209)),s=E(r(178)),l=O(r(418)),d=E(r(422)),f=r(128),p=r(439),c=r(2210),h=E(r(423)),v=E(r(419)),m=E(r(1375)),y=E(r(1458)),g=E(r(1373)),S=E(r(421)),b=E(r(1374)),M=E(r(426)),_=r(4),C=r(21);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function P(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});if(1===i)t.children=a;else if(i>1){for(var s=new Array(i),l=0;l<i;l++)s[l]=arguments[l+3];t.children=s}return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}var R="developers",w="publishers",A=(0,c.callMeMaybe)(u.fetchCompanies),N=function(e){return null!=e?e.map(function(e){return e.name}):[]},j=function(e){return e.trim().toLowerCase()},F=function(e,t){return Object.keys(e).reduce(function(r,n){var a=n.startsWith(R),o=n.startsWith(w);if(a||o){var i=e[n],s=j(i);return""===s?r:r.concat(A(s,{name:i}).then(function(e,t){return function(r){return null==r||0===r.length?u.createCompany(t,{name:e}).then(function(t){return A.setResolveValue(j(e),[t]),t}):r[0]}}(i,t)).then(function(e){return{type:a?R:w,id:e.id}}))}return r},[])},I=function(e){var t,r;function n(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).formRef=a.createRef(),t.developersRef=a.createRef(),t.publishersRef=a.createRef(),t.state={errorMessage:null,hasUnsavedChanges:!1,isSubmitting:!1,hasSubmitted:!1},t.handleMetadataFormChange=function(){t.state.hasUnsavedChanges||t.setState({hasUnsavedChanges:!0})},t.handleMetadataFormReset=function(){var e=t.formRef.current,r=t.publishersRef.current,n=t.developersRef.current;null!=e&&e.resetForm(),null!=r&&r.resetInputFields(),null!=n&&n.resetInputFields(),t.setState({errorMessage:null,hasSubmitted:!1,hasUnsavedChanges:!1})},t.handleMetadataFormSubmit=function(e){var r=t.props.application;t.setState({isSubmitting:!0},function(){Promise.all(F(e,r.owner.id)).then(function(t){var n,a=t.reduce(function(e,t){return e[t.type].push(t.id),e},((n={})[w]=[],n[R]=[],n));return i.updateApplication(r.id,{developer_ids:a[R],publisher_ids:a[w],news_rss_feed_url:e.rssFeedUrl})}).then(function(){t.setState({errorMessage:null,hasSubmitted:!0,hasUnsavedChanges:!1,isSubmitting:!1})}).catch(function(e){var r,n=e.getFieldMessage("news_rss_feed_url");r=e.code===_.APIErrorCodes.UNKNOWN_ERROR&&null!=n?C.Messages.Metadata.NEWS_RSS_FEED_URL_ERROR_MESSAGE.format({apiErrorMessage:n}):(0,f.getMessageFromAPIError)(e,C.Messages.Errors.ERROR_SUBMITTING_FORM.format()),t.setState({errorMessage:r,hasSubmitted:!1,isSubmitting:!1})})})},t}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var o=n.prototype;return o.componentDidMount=function(){var e=this.props.application,t=e.developers,r=void 0===t?[]:t,n=e.publishers,a=void 0===n?[]:n,o=r.concat(a),i=Array.isArray(o),u=0;for(o=i?o:o[Symbol.iterator]();;){var s;if(i){if(u>=o.length)break;s=o[u++]}else{if((u=o.next()).done)break;s=u.value}var l=s;A.setResolveValue(j(l.name),[l])}},o.renderCompanyFields=function(){var e=this.props.application;return(0,p.hasFlag)(e.owner.flags,_.UserFlags.TEAM_PSEUDO_USER)?P(a.Fragment,{},void 0,P(l.GridSection,{},void 0,P(l.GridChild,{columnSpread:12,columnSpreadMedium:8,columnSpreadLarge:6,columnSpreadExtraLarge:6},void 0,P(v.default,{},void 0,C.Messages.Metadata.DEVELOPERS),a.createElement(y.default,{maxCount:5,namePrefix:R,onChange:this.handleMetadataFormChange,type:C.Messages.Metadata.DEVELOPERS,values:N(e.developers),ref:this.developersRef}))),P(l.GridSection,{},void 0,P(l.GridChild,{columnSpread:12,columnSpreadMedium:8,columnSpreadLarge:6,columnSpreadExtraLarge:6},void 0,P(v.default,{},void 0,C.Messages.Metadata.PUBLISHERS),a.createElement(y.default,{maxCount:5,namePrefix:w,onChange:this.handleMetadataFormChange,type:C.Messages.Metadata.PUBLISHERS,values:N(e.publishers),ref:this.publishersRef})))):null},o.renderFormStatus=function(){var e=this.state,t=e.errorMessage,r=e.hasSubmitted;return null!=t?P(m.default,{type:m.default.Types.ERROR},void 0,t):r?P(m.default,{type:m.default.Types.SUCCESS},void 0,C.Messages.Alerts.SUCCESS_CHANGES_SAVED):null},o.render=function(){var e=this.state,t=e.hasUnsavedChanges,r=e.isSubmitting,n=this.props.application;return a.createElement(h.default,{onChange:this.handleMetadataFormChange,onSubmit:this.handleMetadataFormSubmit,ref:this.formRef},P(S.default,{},void 0,P(g.default,{},void 0,C.Messages.Metadata.HEADING),P(b.default,{isFlush:!0},void 0,C.Messages.Metadata.SUBHEADING),this.renderFormStatus()),P(S.default,{isFlush:!0},void 0,P(l.default,{},void 0,P(l.GridSection,{},void 0,P(l.GridChild,{columnSpread:12},void 0,P(v.default,{},void 0,C.Messages.Metadata.NEWS_RSS_FEED_URL),P(d.default,{name:"rssFeedUrl",defaultValue:n.news_rss_feed_url}))),this.renderCompanyFields())),P(M.default,{isVisible:t,onReset:this.handleMetadataFormReset,submitting:r}))},n}(a.Component);I.displayName="Metadata";var U=o.default.connectStores([s.default],function(e){var t=e.match.params.id;return{application:s.default.getApplication(t)}})(I);t.default=U},2209:function(e,t,r){"use strict";t.__esModule=!0,t.fetchCompanies=t.createCompany=void 0;var n=s(r(84)),a=s(r(22)),o=r(128),i=s(r(23)),u=r(4);function s(e){return e&&e.__esModule?e:{default:e}}t.createCompany=function(e,t){return n.default.post({url:u.Endpoints.TEAM_COMPANIES(e),body:{name:t.name}}).then(function(e){return a.default.dispatch({type:i.default.COMPANY_CREATE_SUCCESS,company:e.body}),e.body}).catch(o.APIErrorHandler)};t.fetchCompanies=function(e){return n.default.get({url:u.Endpoints.COMPANIES,query:{name:e.name}}).then(function(e){return a.default.dispatch({type:i.default.COMPANY_QUERY_SUCCESS,companies:e.body}),e.body})}},2210:function(e,t,r){"use strict";t.__esModule=!0,t.callMeMaybe=void 0;t.callMeMaybe=function(e){var t=new Set,r=new Map,n=new Map,a=new Map,o=new Map,i=function(e,r,n,a){return function(o){var i=r.get(e),u=a(o);if(null!=i){for(;i.length>0;)i.shift()(u);r.delete(e)}return n.set(e,o),t.delete(e),u}},u=function(e,t,r){var n=t.get(e)||[];t.set(e,n.concat(r))},s=function(s){if(a.has(s))return Promise.resolve(a.get(s));if(o.has(s))return Promise.reject(o.get(s));if(t.has(s))return new Promise(function(e,t){u(s,r,e),u(s,n,t)});t.add(s);for(var l=arguments.length,d=new Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return e.apply(void 0,d).then(i(s,r,a,Promise.resolve.bind(Promise)),i(s,n,o,Promise.reject.bind(Promise)))};return s.setResolveValue=function(e,t){a.set(e,t)},s}}}]);
//# sourceMappingURL=ef00f7ecf2160fb9b5d8.js.map